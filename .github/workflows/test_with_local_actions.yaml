name: Test Local Action

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Generate Release Notes
        uses: ./
        id: release

      - name: Display pure changelog from output
        run: |
          echo "=== 纯 Changelog 输出 ==="
          echo "${{ steps.release.outputs.changelog }}"

      - name: Display complete release notes from output
        run: |
          echo "=== 完整 Release Notes 输出 ==="
          echo "${{ steps.release.outputs.release-notes }}"

      - name: Generate Release Notes to file
        uses: ./
        id: release_file
        with:
          output-file: RELEASE_NOTES.md

      - name: Display saved file
        run: |
          echo "=== 从文件读取 Release Notes ==="
          cat RELEASE_NOTES.md
